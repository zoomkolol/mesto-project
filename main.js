(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{HT:()=>K,Y2:()=>Q,n1:()=>Y,V7:()=>I,xx:()=>z});var t=function(e){e.setAttribute("disabled","")},n=function(e,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?n.removeAttribute("disabled"):t(n)},o=document.querySelectorAll(".popup"),r=document.querySelector(".popup__edit-profile"),c=document.querySelector(".popup__edit-card"),u=document.querySelector(".popup__edit-avatar");function i(e){document.addEventListener("keydown",s),e.classList.add("popup_opened")}function a(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",s)}function s(e){"Escape"===e.key&&a(document.querySelector(".popup_opened"))}o.forEach((function(e){return e.addEventListener("click",(function(e){(e.target.classList.contains("popup__close")||e.target.classList.contains("popup__overlay"))&&function(e){a(e.closest(".popup"))}(e.target)}))}));var l={baseUrl:"https://nomoreparties.co/v1/plus-cohort-26",headers:{authorization:"2c7dd9fd-d8e0-4401-88fd-d84a69cc2a4c","Content-Type":"application/json"}};function d(e,t){e.textContent=t?"Сохранение...":"Сохранить"}function p(e,t){return fetch("https://nomoreparties.co/v1/plus-cohort-26/cards/".concat(e),{method:"DELETE",headers:l.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then(K(t)).catch((function(e){return console.log(e)}))}var f,m,h,_,v,y,S=document.querySelector("#card-template").content,q=document.querySelector(".profile"),k=q.querySelector(".profile__edit"),g=q.querySelector(".profile__add"),b=q.querySelector(".profile__avatar-container"),E=document.querySelector(".popup__image"),L=document.querySelector(".popup__img-description"),C=document.querySelector(".popup__image-container"),j=document.querySelector(".profile__name"),x=document.querySelector(".profile__description"),A=document.querySelector(".profile__avatar"),P=document.querySelector("#popup__submit-edit-profile_btn"),T=document.querySelector("#popup__submit-edit-card_btn"),O=document.querySelector("#popup__submit-edit-avatar_btn"),N=document.forms["edit-profile"],w=document.forms["edit-card"],D=document.forms["edit-avatar"],H=document.querySelector('input[name="name"]'),J=document.querySelector('input[name="status"]'),M=document.querySelector('input[name="avatar"]'),V=document.querySelector('input[name="place"]'),B=document.querySelector('input[name="link"]'),U=document.querySelector(".cards");function z(e,t){j.textContent=e,x.textContent=t}function Y(e){A.src=e}function F(e,t){i(C),E.setAttribute("src",e),E.setAttribute("alt",t),L.textContent=t}function G(e,t,n){n.target.classList.contains("card__like_active")?function(e,t,n){fetch("https://nomoreparties.co/v1/plus-cohort-26/cards/likes/".concat(e),{method:"DELETE",headers:l.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return I(e.likes.length,t,n)})).catch((function(e){return console.log(e)}))}(e,t,n):function(e,t,n){fetch("https://nomoreparties.co/v1/plus-cohort-26/cards/likes/".concat(e),{method:"PUT",headers:l.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return I(e.likes.length,t,n)})).catch((function(e){return console.log(e)}))}(e,t,n)}function I(e,t,n){t.textContent=e,n.target.classList.toggle("card__like_active")}function K(e){e.target.closest(".card").remove()}function Q(e,t,n,o,r,c,u){var i=function(e,t,n,o,r,c,u,i,a,s,l){null==e&&console.log("cardName is "+e);var d=S.querySelector(".card").cloneNode(!0),p=d.querySelector(".card__image"),f=d.querySelector(".card__description"),m=d.querySelector(".card__like-counter"),h=d.querySelector(".card__delete"),_=d.querySelector(".card__like");return f.textContent=e,p.setAttribute("src",t),p.setAttribute("alt",e),m.textContent=n,c&&_.classList.add("card__like_active"),_.addEventListener("click",(function(e){i(r,m,e)})),o?h.addEventListener("click",(function(e){a(r,e)})):h.remove(),p.addEventListener("click",(function(){return u(t,e)})),d}(e,t,n,o,r,c,F,G,p);u?U.append(i):U.prepend(i)}m=(f={formSelector:".popup__form",inputSelector:".popup__text",submitButtonSelector:".popup__submit",inputErrorClass:"popup__text_type_error",errorClass:"popup__text_error_active"}).formSelector,h=f.inputSelector,_=f.submitButtonSelector,v=f.inputErrorClass,y=f.errorClass,Array.from(document.querySelectorAll(m)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,o,r,c,u){var i=Array.from(e.querySelectorAll(o)),a=e.querySelector(r);n(i,a),e.addEventListener("reset",(function(){t(a)})),i.forEach((function(t){t.addEventListener("input",(function(){!function(e,t,n,o){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"_error"));t.classList.remove(n),r.classList.remove(o),r.textContent=""}(e,t,n,o):function(e,t,n,o,r){var c=e.querySelector(".".concat(t.id,"_error"));t.classList.add(o),c.textContent=n,c.classList.add(r)}(e,t,t.validationMessage,n,o)}(e,t,c,u),n(i,a)}))}))}(e,h,_,v,y)})),k.addEventListener("click",(function(){return function(e,t,n,o){e.value=n.textContent,t.value=o.textContent,i(r)}(H,J,j,x)})),g.addEventListener("click",(function(){i(c)})),b.addEventListener("click",(function(){i(u)})),N.addEventListener("submit",(function(){var e,t,n;e=H.value,t=J.value,d(n=P,!0),fetch("https://nomoreparties.co/v1/plus-cohort-26/users/me",{method:"PATCH",headers:l.headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return e.json()})).then((function(e){z(e.name,e.about)})).catch((function(e){return console.log(e)})).finally((function(){d(n,!1)})),a(r)})),D.addEventListener("submit",(function(){var e,t;e=M.value,d(t=O,!0),fetch("https://nomoreparties.co/v1/plus-cohort-26/users/me/avatar",{method:"PATCH",headers:l.headers,body:JSON.stringify({avatar:e})}).then((function(e){return e.json()})).then((function(e){return Y(e.avatar)})).catch((function(e){return console.log(e)})).finally((function(){d(t,!1)})),a(u)})),w.addEventListener("submit",(function(){var e,t,n;e=V.value,t=B.value,d(n=T,!0),fetch("https://nomoreparties.co/v1/plus-cohort-26/cards",{method:"POST",headers:l.headers,body:JSON.stringify({name:e,link:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){Q(e.name,e.link,e.likes.length,!0,e._id,!1,!1)})).catch((function(e){return console.log(e)})).finally((function(){d(n,!1)})),w.reset(),a(c)})),fetch("https://nomoreparties.co/v1/plus-cohort-26/users/me",{headers:l.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){var t;z(e.name,e.about),Y(e.avatar),t=e._id,fetch("https://nomoreparties.co/v1/plus-cohort-26/cards",{headers:l.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.forEach((function(e){var n=!1;e.likes.find((function(e){return e._id===t}))&&(n=!0),t===e.owner._id?Q(e.name,e.link,e.likes.length,!0,e._id,n,!0):Q(e.name,e.link,e.likes.length,!1,e._id,n,!0)}))})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))})();